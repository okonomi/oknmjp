---
import { format } from "date-fns"
import BaseHead from "@/components/BaseHead.astro"
import Header from "@/components/Header.astro"
import Footer from "@/components/Footer.astro"
import { SITE_TITLE, SITE_DESCRIPTION } from "@/config"
import { getCollection } from "astro:content"

const posts = (await getCollection("posts")).sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
---

<!doctype html>
<html lang="ja">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} pageType="website" />
  </head>
  <body>
    <div class="w-full max-w-2xl px-4 mx-auto">
      <Header />
      <main class="py-8">
        <div class="space-y-2">
          {posts.map((post) => (
            <div class="flex flex-col sm:flex-row">
              <time class="text-gray-600 shrink-0 w-[100px]" datetime={post.data.pubDate.toISOString()}>
                {format(post.data.pubDate, "yyyy-MM-dd")}
              </time>
              <a href={`/posts/${post.slug}`} class="text-blue-600 hover:underline">
                {post.data.title}
              </a>
            </div>
          ))}
        </div>
      </main>
      <Footer />
    </div>
  </body>
</html>
